

RRULE:FREQ=YEARLY;INTERVAL=1
RRULE:FREQ=MONTHLY;INTERVAL=1
RRULE:FREQ=WEEKLY;INTERVAL=1
RRULE:FREQ=DAILY;INTERVAL=1
RRULE:FREQ=HOURLY;INTERVAL=1
RRULE:FREQ=MINUTELY;INTERVAL=1
RRULE:FREQ=SECONDLY;INTERVAL=1


RRULE:FREQ=SECONDLY;BYMONTH=3
RRULE:FREQ=SECONDLY;BYMONTH=3;BYWEEKNO=5
RRULE:FREQ=SECONDLY;BYMONTH=3;BYYEARDAY=80
RRULE:FREQ=SECONDLY;BYMONTH=3;BYYEARDAY=80;BYMONTHDAY=20
RRULE:FREQ=SECONDLY;BYMONTH=3;BYYEARDAY=80;BYMONTHDAY=20;BYDAY=TH;BYHOUR=10;BYMINUTE=20;BYSECOND=30
RRULE:FREQ=SECONDLY;BYMONTH=3;BYYEARDAY=80;BYMONTHDAY=20;BYDAY=TH;BYHOUR=10;BYMINUTE=20;BYSECOND=30;BYSETPOS=-1


var FREQ_SECONDLY = 1;
var FREQ_MINUTELY = 2;
var FREQ_HOURLY = 4;
var FREQ_DAILY = 8;
var FREQ_WEEKLY = 16;
var FREQ_MONTHLY = 32;
var FREQ_YEARLY = 64;
var FREQ_ALL = 127;

var FREQ_HMS = FREQ_SECONDLY | FREQ_MINUTELY | FREQ_HOURLY;

var FREQ_ALLOW_BYWEEKNO = FREQ_YEARLY;
var FREQ_ALLOW_BYYEARDAY = FREQ_SECONDLY | FREQ_MINUTELY | FREQ_HOURLY | FREQ_YEARLY;
var FREQ_ALLOW_BYMONTHDAY = FREQ_SECONDLY | FREQ_MINUTELY | FREQ_HOURLY | FREQ_MONTHLY | FREQ_YEARLY;

// Checking freq+interval
switch (freq) {
  case FREQ_SECONDLY: if (secondsBetween(rangeStart,rangeEnd)


// Checking bymonth:

let months = [];

if (bymonth) {
  months = union(set(bymonth), set(monthsInRange(rangeStart, rangeEnd)))
  if (!months.length) {
    return [];
  }
}

if (byweekno && ((freq & FREQ_ALLOW_BYWEEKNO) != 0)) {
  weeknos = union(set(byweekno), set(weekNumsInRange(rangeStart, rangeEnd)));
  if (!weeknos.length) {
    return [];
  }
}

if (byyearday && ((freq & FREQ_ALLOW_BYYEARDAY) != 0)) {
  // TODO maybe just check each one in byyearday for the range?
  yeardays = union(set(byyearday), set(yeardaysInRange(rangeStart, rangeEnd)));
  if (!yeardays.length) {
    return [];
  }
}
  
...
