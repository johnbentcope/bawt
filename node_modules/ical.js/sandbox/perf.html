<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
    <script type="text/javascript" src="../build/ical.js"></script>
    <script type="text/javascript" src="underscore-min.js"></script>
    <script type="text/javascript" src="rrule.js"></script>
    <script type="text/javascript" src="rrule2.js"></script>
    <script>
      var tzString = "BEGIN:VTIMEZONE\r\n" +
      "TZID:Africa/Casablanca\r\n" +
      "X-LIC-LOCATION:Africa/Casablanca\r\n" +
      "BEGIN:STANDARD\r\n" +
      "TZOFFSETFROM:+0100\r\n" +
      "TZOFFSETTO:+0000\r\n" +
      "TZNAME:WET\r\n" +
      "DTSTART:19700927T030000\r\n" +
      "RRULE:FREQ=YEARLY;BYDAY=-1SU;BYMONTH=9\r\n" +
      "END:STANDARD\r\n" +
      "BEGIN:DAYLIGHT\r\n" +
      "TZOFFSETFROM:+0100\r\n" +
      "TZOFFSETTO:+0100\r\n" +
      "TZNAME:WEST\r\n" +
      "DTSTART:19700426T020000\r\n" +
      "RRULE:FREQ=YEARLY;BYDAY=-1SU;BYMONTH=4\r\n" +
      "END:DAYLIGHT\r\n" +
      "END:VTIMEZONE";

      function perf(x) {
        var i = 100;
        var st = performance.now();
        while (i--) {
            x();
        }
        var en = performance.now();
        console.log((en - st) / 100);
      }


      function go() {
        var tzComp = new ICAL.Component(ICAL.parse(tzString)[1]);
        var tzid = tzComp.getFirstPropertyValue("tzid");
        var timezone = new ICAL.Timezone(tzComp);

        var dt = new ICAL.Time.fromString("2014-03-13T01:02:03");
        dt.zone = timezone;
        dt.toUnixTime();
      }

      function go2() {
        var rr = new RRule({
          freq: RRule.YEARLY,
          interval: 1,
          byweekday: [RRule.SU.nth(-1)],
          bymonth: 9,
          dtstart: new Date(1970, 0, 1, 0, 0)
        });

        var occ = rr.between(new Date(1970, 1, 1), new Date(2019, 11, 31));
      }

      function go3() {
        var rule = {
            freq: "SECONDLY",
            parts: {
              BYSECOND: [20,30,40]
            }


        };

        var dt = new ICAL.Time.fromString("2014-03-13T01:02:03");
        var rr = new RecurIterator(dt, rule);

        return rr.next();
      }


    </script>
  </head>
  <body>
    <input type="button" onclick="perf(go)" value="Run it">
    <input type="button" onclick="perf(go2)" value="rrule.js">
    <input type="button" onclick="perf(go3)" value="new parser perf">
    <input type="button" onclick="console.log(go3().toString())" value="new parser">
  </body>
</html>
